{% extends 'base.html' %} {% block content %} Short Link: {{ link.short_link }}
<a href="{{ link.long_link }}">Long Link</a>

<form id="delete-form" method="POST">
  <input type="hidden" name="_method" value="DELETE" />
  <button type="button" onclick="deleteLink()">Delete</button>
</form>
<form>
  <button id="generate-qrcode-btn" type="button">Generate QR code</button>
</form>

<div id="qrcode-container"></div>

<script>
  function deleteLink() {
    if (confirm('Are you sure you want to delete this link?')) {
      document.getElementById('delete-form').submit();
    }
  }
</script>
<script>
  document
    .getElementById('generate-qrcode-btn')
    .addEventListener('click', function () {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', '/detail/{{link.id}}/qr_code', true);
      xhr.responseType = 'arraybuffer';
      xhr.onload = function () {
        if (xhr.status === 200) {
          var qrCodeBlob = new Blob([xhr.response], { type: 'image/png' });
          var qrCodeURL = URL.createObjectURL(qrCodeBlob);
          var qrCodeImg = document.createElement('img');
          qrCodeImg.src = qrCodeURL;
          document.getElementById('qrcode-container').innerHTML = '';
          document.getElementById('qrcode-container').appendChild(qrCodeImg);
        } else {
          alert('Failed to generate QR code');
        }
      };
      xhr.send();
    });
</script>

{% endblock %}
